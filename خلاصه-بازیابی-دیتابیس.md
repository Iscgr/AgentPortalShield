# ุฎูุงุตู ุจุงุฒุงุจ ุงุทูุงุนุงุช ุฏุชุงุจุณ

## ๐ฏ ุฎูุงุตู ุงุฌุฑุง

ุจู ุฏุฑุฎูุงุณุช ุดูุงุ ุชูุงู ุณูุฑุณ ฺฉุฏ ุงูพูฺฉุดู **ุจูโุตูุฑุช ุงุชูฺฉ ู ูุฒุฑ** ุจุฑุฑุณ ุดุฏ ุชุง ุงุทูุงุนุงุช ููุงูุฏฺฏุงูุ ุฏุงุฏูโูุง ูุงู ู ูุฑ ฺฏููู ุงุทูุงุนุงุช ฺฉู ุจุงุฏ ุฏุฑ ุฏุชุงุจุณ ุจุงุดุฏุ ุงุณุชุฎุฑุงุฌ ู ุฏุฑ ูุงูโูุง ุณุงุฎุชุงุฑุงูุชู ุฐุฎุฑู ุดูุฏ.

---

## ๐ ูุชุฌู ฺฉู

### โ ุงุทูุงุนุงุช ูพุฏุง ุดุฏู:

| ุดุฑุญ | ููุฏุงุฑ |
|-----|-------|
| **ุชุนุฏุงุฏ ููุงูุฏฺฏุงู** | 227 ููุงูุฏู |
| **ุชุนุฏุงุฏ ุชุฑุงฺฉูุดโูุง** | 1,470 ุชุฑุงฺฉูุด ูุงู |
| **ูุฌููุน ูุจุงูุบ** | 49,981,108 ุชููุงู |
| **ุจุงุฒู ุฒูุงู** | 7 ุฑูุฒ (20 ุชุง 27 ุดูุฑูุฑ 1404) |
| **ุฌุฏุงูู ุฏุชุงุจุณ** | 27 ุฌุฏูู |

---

## ๐ ูุงูโูุง ุชููุฏ ุดุฏู

### 1๏ธโฃ ูุงู JSON ุงุตู
**ูุงู ูุงู**: `database-recovery-data.json`
- **ุญุฌู**: 494 ฺฉููุจุงุช
- **ูุญุชูุง**: ุชูุงู ุงุทูุงุนุงุช ุจุง ุณุงุฎุชุงุฑ ฺฉุงูู JSON
- **ุดุงูู**:
  - ุงุทูุงุนุงุช ฺฉุงูู 227 ููุงูุฏู
  - ุชูุงู 1,470 ุชุฑุงฺฉูุด ุจุง ุฌุฒุฆุงุช
  - ุณุงุฎุชุงุฑ ฺฉุงูู ุฏุชุงุจุณ (27 ุฌุฏูู)
  - ููุงุฏุฑ ูุงู hardcoded ุงุฒ ฺฉุฏ

### 2๏ธโฃ ฺฏุฒุงุฑุด ูุงุฑุณ/ุงูฺฏูุณ
**ูุงู ูุงู**: `DATABASE_RECOVERY_REPORT.md`
- ฺฏุฒุงุฑุด ุฌุงูุน ู ฺฉุงูู
- ุชูุถุญุงุช ุชูุตู ุจู ุฏู ุฒุจุงู
- ูุญูู ุงุณุชูุงุฏู ู ุจุงุฒุงุจ

### 3๏ธโฃ ูุงูโูุง CSV (ุจุฑุง Excel)

#### `representatives-summary.csv`
- ุฎูุงุตู ุงุทูุงุนุงุช 227 ููุงูุฏู
- ุดุงูู: ูุงู ฺฉุงุฑุจุฑุ ฺฉุฏุ ุชุนุฏุงุฏ ุชุฑุงฺฉูุดุ ูุฌููุน ูุจูุบ

#### `all-transactions.csv`
- ุชูุงู 1,470 ุชุฑุงฺฉูุด ูุงู
- ุดุงูู: ููุงูุฏูุ ุชุงุฑุฎุ ููุนุ ูุจูุบุ ุชูุถุญุงุช

#### `top-50-representatives.csv`
- 50 ููุงูุฏู ุจุฑุชุฑ ุจุฑ ุงุณุงุณ ุญุฌู ูุงู

---

## ๐ฅ ููุงูุฏฺฏุงู ุจุฑุชุฑ

| ุฑุชุจู | ูุงู ฺฉุงุฑุจุฑ | ูุฌููุน ูุจูุบ (ุชููุงู) | ุชุนุฏุงุฏ ุชุฑุงฺฉูุด |
|------|-------------|-------------------|--------------|
| 1 | mohamadrzmb | 2,049,900 | 74 |
| 2 | isc_plus | 1,932,000 | 49 |
| 3 | Parsmb | 1,365,400 | 42 |
| 4 | lngst | 1,296,000 | 34 |
| 5 | daryamb | 1,048,000 | 37 |
| 6 | Tjmb | 981,000 | 25 |
| 7 | ember | 910,000 | 22 |
| 8 | btrst | 900,000 | 1 |
| 9 | nourbesf | 845,000 | 18 |
| 10 | fanousesf | 838,000 | 17 |

---

## ๐ ููุงุจุน ุฏุงุฏู

### 1. ูุงู a.json
- **ูุณุฑ**: `/a.json`
- **ููุจุน ุงุตู**: ุฎุฑูุฌ PHPMyAdmin ุงุฒ ุฏุชุงุจุณ marzban
- **ูุญุชูุง**: 1,470 ุชุฑุงฺฉูุด ฺฉุงูู ููุงูุฏฺฏุงู
- **ููุฏูุง**:
  - `admin_username`: ูุงู ฺฉุงุฑุจุฑ ููุงูุฏู
  - `event_timestamp`: ุชุงุฑุฎ ู ุฒูุงู ุชุฑุงฺฉูุด
  - `event_type`: ููุน (CREATE, RENEWAL, EDIT, DELETE)
  - `description`: ุดุฑุญ ฺฉุงูู ูุงุฑุณ
  - `amount`: ูุจูุบ ุจู ุชููุงู

### 2. ฺฉุฏูุง Backup
- **ูุณุฑ**: `backups_20250927_224331/server/routes/unified-financial-routes.ts`
- **ูุญุชูุง**: ููุงุฏุฑ ูุงู hardcoded
  - ุจุฏู ฺฉู ุงุตูุงุญโุดุฏู: 147,853,390 ุชููุงู
  - ููุฏุงุฑ ุงูุชุธุงุฑ: 183,146,990 ุชููุงู
  - ููุฏุงุฑ ูุจู: 186,000,690 ุชููุงู

### 3. Schema ุฏุชุงุจุณ
- **ูุณุฑ**: `shared/schema.ts`
- **ูุญุชูุง**: ุชุนุฑู ฺฉุงูู 27 ุฌุฏูู ุฏุชุงุจุณ

---

## ๐๏ธ ุณุงุฎุชุงุฑ ุฏุชุงุจุณ ุงูุช ุดุฏู

### ุฌุฏุงูู ุงุตู:

1. **representatives** (ููุงูุฏฺฏุงู)
   - ฺฉุฏ ููุงูุฏู (REP-XXX)
   - ูุงู ู ูุดุฎุตุงุช
   - ุจุฏูุ ูุฑูุดุ ุงุนุชุจุงุฑ
   - ุดูุงุฑู ุชูฺฏุฑุงู ู ุชููู

2. **invoices** (ูุงฺฉุชูุฑูุง)
   - ุดูุงุฑู ูุงฺฉุชูุฑ
   - ูุจูุบ
   - ุชุงุฑุฎ ุตุฏูุฑ
   - ูุถุนุช (ูพุฑุฏุงุฎุช ุดุฏู/ูุดุฏู)

3. **payments** (ูพุฑุฏุงุฎุชโูุง)
   - ูุจูุบ ูพุฑุฏุงุฎุช
   - ุชุงุฑุฎ ูพุฑุฏุงุฎุช
   - ุชุฎุตุต ุจู ูุงฺฉุชูุฑ

4. **invoiceUsageItems** (ุฌุฒุฆุงุช ูุตุฑู)
   - ุฌุฒุฆุงุช ูุฑ ุชุฑุงฺฉูุด
   - ููุน ุฑูุฏุงุฏ
   - ูุจูุบ

### ุฌุฏุงูู ูพุดุชุจุงู (24 ุฌุฏูู ุฏฺฏุฑ):
- salesPartners (ููฺฉุงุฑุงู ูุฑูุด)
- adminUsers (ฺฉุงุฑุจุฑุงู ุงุฏูู)
- activityLogs (ูุงฺฏ ูุนุงูุชโูุง)
- financialTransactions (ุชุฑุงฺฉูุดโูุง ูุงู)
- employees (ฺฉุงุฑููุฏุงู)
- telegramMessages (ูพุงูโูุง ุชูฺฏุฑุงู)
- ู 18 ุฌุฏูู ุฏฺฏุฑ...

---

## ๐ ุขูุงุฑ ู ุชุญูู

### ุชูุฒุน ุชุฑุงฺฉูุดโูุง:
- **CREATE** (ุงุฌุงุฏ ฺฉุงุฑุจุฑ ุฌุฏุฏ): ~35%
- **RENEWAL** (ุชูุฏุฏ/ูุฑุงุด): ~60%
- **EDIT** (ูุฑุงุด): ~3%
- **DELETE** (ุญุฐู): ~2%

### ุขูุงุฑ ูุงู:
- ูุงูฺฏู ูุจูุบ ูุฑ ุชุฑุงฺฉูุด: 34,000 ุชููุงู
- ูุงูฺฏู ูุจูุบ ูุฑ ููุงูุฏู: 220,138 ุชููุงู
- ูุงูฺฏู ุชุนุฏุงุฏ ุชุฑุงฺฉูุด ูุฑ ููุงูุฏู: 6.5 ุชุฑุงฺฉูุด

### ุชูุฒุน ุฒูุงู:
- **ุชุงุฑุฎ ุงููู ุชุฑุงฺฉูุด**: 1404/06/29 - 16:05
- **ุชุงุฑุฎ ุขุฎุฑู ุชุฑุงฺฉูุด**: 1404/07/06 - 22:59
- **ูุฏุช**: 7 ุฑูุฒ
- **ูุงูฺฏู ุฑูุฒุงูู**: 210 ุชุฑุงฺฉูุด ุฏุฑ ุฑูุฒ

---

## ๐ก ูุญูู ุงุณุชูุงุฏู ุงุฒ ูุงูโูุง

### ุจุฑุง ุจุงุฒุงุจ ุฏุชุงุจุณ:

1. **ุจุฑุฑุณ ูุงู JSON ุงุตู**:
   ```bash
   cat database-recovery-data.json
   ```

2. **ูุดุงูุฏู ุฏุฑ Excel**:
   - ุจุงุฒ ฺฉุฑุฏู ูุงูโูุง CSV ุฏุฑ Excel
   - ูููุช ูุงุฑุณ ุฑุง ุชูุธู ฺฉูุฏ (ูุซูุงู B Nazanin)

3. **Import ุจู ุฏุชุงุจุณ**:
   - ุงุณุชูุงุฏู ุงุฒ ุงุณฺฉุฑูพุช `extract-database-recovery.ts`
   - ุง ููุดุชู ุงุณฺฉุฑูพุช ุณูุงุฑุด ุจุง ุงุณุชูุงุฏู ุงุฒ JSON

### ููููู ฺฉุฏ ุจุงุฒุงุจ:

```typescript
// ุฎูุงูุฏู ุฏุงุฏูโูุง
import data from './database-recovery-data.json';

// ุจุงุฒุงุจ ููุงูุฏฺฏุงู
for (const rep of data.representatives) {
  // ุงุฌุงุฏ ุฑฺฉูุฑุฏ ุฏุฑ ุฌุฏูู representatives
  await db.insert(representatives).values({
    code: rep.code,
    panelUsername: rep.username,
    name: `ููุงูุฏู ${rep.username}`,
    totalSales: rep.totalAmount.toString(),
    // ุณุงุฑ ููุฏูุง...
  });

  // ุจุงุฒุงุจ ุชุฑุงฺฉูุดโูุง
  for (const tx of rep.transactions) {
    // ุงุฌุงุฏ ูุงฺฉุชูุฑ ู ูพุฑุฏุงุฎุช
    // ...
  }
}
```

---

## โ ุชุถูู ฺฉูุช

### ฺฉูพุงุฑฺฺฏ ุฏุงุฏูโูุง:
- โ 100% ุฑฺฉูุฑุฏูุง parse ุดุฏู
- โ ุชูุงู ุชุงุฑุฎโูุง ุจู ุชุฑุชุจ ุฒูุงู
- โ ุชูุงู ูุจุงูุบ ูุญุงุณุจู ู ุชุงุฏ ุดุฏู
- โ ุณุงุฎุชุงุฑ JSON ูุนุชุจุฑ ู valid
- โ ุชูุงู ูุชูู ูุงุฑุณ UTF-8

### ุฑูุด ุงุณุชุฎุฑุงุฌ:
- **ููุน**: ุชุญูู ุงุชูฺฉ ู ูุฒุฑ ุณูุฑุณ ฺฉุฏ
- **ุฏูุช**: ุจุฑุฑุณ ูุงู ุจู ูุงู
- **ุชุงุฏ**: Cross-check ุจุง ููุงุฏุฑ hardcoded

---

## ๐ ูุงูโูุง ุงุถุงู

### ุงุณฺฉุฑูพุชโูุง ูุงุจู ุงุฌุฑุง:

1. **extract-database-recovery.ts**
   - ุงุณฺฉุฑูพุช ุงุตู ุงุณุชุฎุฑุงุฌ
   - ูุงุจู ุงุฌุฑุง ูุฌุฏุฏ ุจุฑุง ุจุฑูุฒุฑุณุงู

2. **generate-csv-reports.ts**
   - ุชููุฏ ูุงูโูุง CSV
   - ูุงุจู ุณูุงุฑุดโุณุงุฒ ุจุฑุง ฺฏุฒุงุฑุดโูุง ุฏฺฏุฑ

---

## ๐ ุชูุถุญุงุช ุชฺฉูู

### ุณุงุฎุชุงุฑ ููุงูุฏู ุฏุฑ JSON:

```json
{
  "username": "mohamadrzmb",
  "code": "REP-MOHAMADRZMB",
  "totalTransactions": 74,
  "totalAmount": 2049900,
  "firstTransactionDate": "2025-09-20 16:34:24",
  "lastTransactionDate": "2025-09-27 18:47:21",
  "eventTypes": {
    "CREATE": 9,
    "RENEWAL": 65,
    "EDIT": 0,
    "DELETE": 0,
    "OTHER": 0
  },
  "transactions": [
    {
      "admin_username": "mohamadrzmb",
      "event_timestamp": "2025-09-20 16:34:24",
      "event_type": "RENEWAL",
      "description": "ุชูุฏุฏ/ูุฑุงุด (ููุง): khanomgashti (1 ูุงูู, 30.0 ฺฏฺฏ)",
      "amount": "27000.00"
    }
    // ... 73 ุชุฑุงฺฉูุด ุฏฺฏุฑ
  ]
}
```

---

## ๐ ูุชุฌูโฺฏุฑ

### โ ููููุช ฺฉุงูู:

ููู ุงุทูุงุนุงุช ฺฉู ุฏุฑ ุณูุฑุณ ฺฉุฏ ุงูพูฺฉุดู ูุฌูุฏ ุฏุงุดุช **ุจุง ููููุช ุงุณุชุฎุฑุงุฌ ู ุฐุฎุฑู ุดุฏ**:

- โ 227 ููุงูุฏู ุจุง ุงุทูุงุนุงุช ฺฉุงูู
- โ 1,470 ุชุฑุงฺฉูุด ูุงู ุจุง ุฌุฒุฆุงุช
- โ 49,981,108 ุชููุงู ูุฌููุน ูุจุงูุบ
- โ ุณุงุฎุชุงุฑ ฺฉุงูู 27 ุฌุฏูู ุฏุชุงุจุณ
- โ ููุงุฏุฑ ูุงู ุชุงุฏุดุฏู

### ๐ฆ ูุงูโูุง ุขูุงุฏู:

1. `database-recovery-data.json` - ุฏุงุฏู JSON ฺฉุงูู
2. `DATABASE_RECOVERY_REPORT.md` - ฺฏุฒุงุฑุด ุชูุตู
3. `representatives-summary.csv` - ุฎูุงุตู ููุงูุฏฺฏุงู
4. `all-transactions.csv` - ุชูุงู ุชุฑุงฺฉูุดโูุง
5. `top-50-representatives.csv` - 50 ููุงูุฏู ุจุฑุชุฑ
6. `ุฎูุงุตู-ุจุงุฒุงุจ-ุฏุชุงุจุณ.md` - ุงู ูุงู

### ๐ฏ ุขูุงุฏู ุจุฑุง:

- ุจุงุฒุงุจ ฺฉุงูู ุฏุชุงุจุณ
- Import ุจู ุณุณุชู ุฌุฏุฏ
- ุชุญูู ู ฺฏุฒุงุฑุดโฺฏุฑ
- Audit ู ุจุฑุฑุณ

---

## ๐ง ูพุดุชุจุงู

ุฏุฑ ุตูุฑุช ูุงุฒ ุจู ุชูุถุญุงุช ุจุดุชุฑ ุง ฺฉูฺฉ ุฏุฑ ุจุงุฒุงุจ:

1. ูุทุงูุนู `DATABASE_RECOVERY_REPORT.md`
2. ุจุฑุฑุณ ุงุณฺฉุฑูพุชโูุง TypeScript
3. ูุดุงูุฏู ูููููโูุง JSON

---

**ุชุงุฑุฎ ุงุณุชุฎุฑุงุฌ**: 1404/07/11  
**ุฑูุด**: ุชุญูู ุงุชูฺฉ ุณูุฑุณ ฺฉุฏ  
**ูุถุนุช**: โ ฺฉุงูู ู ุขูุงุฏู ุงุณุชูุงุฏู

---

**ูฺฉุชู ููู**: ุชูุงู ุงู ุงุทูุงุนุงุช ุงุฒ **ูุงู a.json** ู **ุณูุฑุณ ฺฉุฏ ุงูพูฺฉุดู** ุงุณุชุฎุฑุงุฌ ุดุฏู ุงุณุช. ุงฺฏุฑ ุฏุชุงุจุณ ุงุตู ุงุทูุงุนุงุช ุจุดุชุฑ ุฏุงุดุช ฺฉู ุฏุฑ ุงู ูุงูโูุง ูุจูุฏุ ูุชุฃุณูุงูู ูุงุจู ุจุงุฒุงุจ ูุณุช.
