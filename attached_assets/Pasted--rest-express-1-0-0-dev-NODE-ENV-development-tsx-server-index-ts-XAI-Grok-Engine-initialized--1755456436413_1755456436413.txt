
> rest-express@1.0.0 dev
> NODE_ENV=development tsx server/index.ts

✅ XAI Grok Engine initialized successfully
6:46:07 PM [express] Checking database connection...
6:46:08 PM [database] Database connection successful
Query: select "id", "username", "password_hash", "role", "permissions", "is_active", "last_login_at", "created_at" from "admin_users" where "admin_users"."username" = $1 limit $2 -- params: ["mgr", 1]
Query: update "admin_users" set "password_hash" = $1, "role" = $2, "is_active" = $3 where "admin_users"."username" = $4 -- params: ["$2b$12$uwH2hbqFyjkf6HY2sgGhBOjq/zVUAuHqYIxeZmKLdCc0CEkjQnvq6", "SUPER_ADMIN", true, "mgr"]
🔄 Admin user 'mgr' password reset successfully
Query: select "id", "username", "password_hash", "full_name", "email", "role", "permissions", "is_active", "last_login_at", "created_at", "updated_at" from "crm_users" where "crm_users"."username" = $1 limit $2 -- params: ["crm", 1]
Query: update "crm_users" set "password_hash" = $1, "role" = $2, "is_active" = $3 where "crm_users"."username" = $4 -- params: ["$2b$12$XwUK20DF/Qtzo1WyMexOTeQUp3wD7QmkeoQKyYG7HavDgo/bE5ZfS", "CRM_MANAGER", true, "crm"]
🔄 CRM user 'crm' password reset successfully
✅ XAI Grok Engine initialized successfully
✅ Settings routes registered successfully
✅ Standardized Invoice Routes Registered
✅ Maintenance routes registered successfully
Server is running on port 5000
Environment: development
📊 SHERLOCK v28.0: Starting financial monitoring every 30 minutes
🔍 SHERLOCK v28.0: Performing routine financial monitoring check...
📊 SHERLOCK v28.0: Financial monitoring auto-started
🔍 SHERLOCK v28.0: Starting comprehensive financial consistency validation...
Query: select "id", "name", "code", "total_debt", "is_active" from "representatives" where "representatives"."is_active" = $1 -- params: [true]
Query: select "id", "name", "code" from "representatives" where "representatives"."id" = $1 -- params: [1804]
Query: select COUNT(*), COALESCE(SUM(CAST(amount as DECIMAL)), 0), MAX(created_at) from "invoices" where "invoices"."representative_id" = $1 -- params: [1804]
Query: select COUNT(*), COALESCE(SUM(CASE WHEN is_allocated = true THEN CAST(amount as DECIMAL) ELSE 0 END), 0), MAX(payment_date) from "payments" where "payments"."representative_id" = $1 -- params: [1804]
Query: select "total_debt" from "representatives" where "representatives"."id" = $1 -- params: [1804]
Query: select "id", "name", "code" from "representatives" where "representatives"."id" = $1 -- params: [1815]
Query: select COUNT(*), COALESCE(SUM(CAST(amount as DECIMAL)), 0), MAX(created_at) from "invoices" where "invoices"."representative_id" = $1 -- params: [1815]
Query: select COUNT(*), COALESCE(SUM(CASE WHEN is_allocated = true THEN CAST(amount as DECIMAL) ELSE 0 END), 0), MAX(payment_date) from "payments" where "payments"."representative_id" = $1 -- params: [1815]
Query: select "total_debt" from "representatives" where "representatives"."id" = $1 -- params: [1815]
Query: select "id", "name", "code" from "representatives" where "representatives"."id" = $1 -- params: [1839]
Query: select COUNT(*), COALESCE(SUM(CAST(amount as DECIMAL)), 0), MAX(created_at) from "invoices" where "invoices"."representative_id" = $1 -- params: [1839]
Query: select COUNT(*), COALESCE(SUM(CASE WHEN is_allocated = true THEN CAST(amount as DECIMAL) ELSE 0 END), 0), MAX(payment_date) from "payments" where "payments"."representative_id" = $1 -- params: [1839]
Query: select "total_debt" from "representatives" where "representatives"."id" = $1 -- params: [1839]
Query: select "id", "name", "code" from "representatives" where "representatives"."id" = $1 -- params: [1823]
Query: select COUNT(*), COALESCE(SUM(CAST(amount as DECIMAL)), 0), MAX(created_at) from "invoices" where "invoices"."representative_id" = $1 -- params: [1823]
Query: select COUNT(*), COALESCE(SUM(CASE WHEN is_allocated = true THEN CAST(amount as DECIMAL) ELSE 0 END), 0), MAX(payment_date) from "payments" where "payments"."representative_id" = $1 -- params: [1823]
Query: select "total_debt" from "representatives" where "representatives"."id" = $1 -- params: [1823]
Query: select "id", "name", "code" from "representatives" where "representatives"."id" = $1 -- params: [1837]
Query: select COUNT(*), COALESCE(SUM(CAST(amount as DECIMAL)), 0), MAX(created_at) from "invoices" where "invoices"."representative_id" = $1 -- params: [1837]
Query: select COUNT(*), COALESCE(SUM(CASE WHEN is_allocated = true THEN CAST(amount as DECIMAL) ELSE 0 END), 0), MAX(payment_date) from "payments" where "payments"."representative_id" = $1 -- params: [1837]
Query: select "total_debt" from "representatives" where "representatives"."id" = $1 -- params: [1837]
Query: select "id", "name", "code" from "representatives" where "representatives"."id" = $1 -- params: [1798]
Query: select COUNT(*), COALESCE(SUM(CAST(amount as DECIMAL)), 0), MAX(created_at) from "invoices" where "invoices"."representative_id" = $1 -- params: [1798]
Query: select COUNT(*), COALESCE(SUM(CASE WHEN is_allocated = true THEN CAST(amount as DECIMAL) ELSE 0 END), 0), MAX(payment_date) from "payments" where "payments"."representative_id" = $1 -- params: [1798]
Query: select "total_debt" from "representatives" where "representatives"."id" = $1 -- params: [1798]
Query: select "id", "name", "code" from "representatives" where "representatives"."id" = $1 -- params: [1795]
Query: select COUNT(*), COALESCE(SUM(CAST(amount as DECIMAL)), 0), MAX(created_at) from "invoices" where "invoices"."representative_id" = $1 -- params: [1795]
Query: select COUNT(*), COALESCE(SUM(CASE WHEN is_allocated = true THEN CAST(amount as DECIMAL) ELSE 0 END), 0), MAX(payment_date) from "payments" where "payments"."representative_id" = $1 -- params: [1795]
Query: select "total_debt" from "representatives" where "representatives"."id" = $1 -- params: [1795]
Browserslist: browsers data (caniuse-lite) is 10 months old. Please run:
  npx update-browserslist-db@latest
  Why you should do it regularly: https://github.com/browserslist/update-db#readme
Query: select "id", "name", "code" from "representatives" where "representatives"."id" = $1 -- params: [1808]
6:46:10 PM [vite] Pre-transform error: /home/runner/workspace/client/src/pages/representatives.tsx: 'return' outside of function. (2417:2)

  2415 |   };
  2416 |
> 2417 |   return (
       |   ^
  2418 |     <Dialog open={editInvoiceDialogOpen} onOpenChange={setEditInvoiceDialogOpen}>
  2419 |       <DialogContent className="max-w-4xl max-h-[90vh] overflow-hidden bg-gray-900 text-white border-gray-700 flex flex-col">
  2420 |           <DialogHeader className="flex-shrink-0">
